package me.cassioalmeidas;

import java.util.Arrays;

import me.cassioalmeidas.ann.MLP;

public class Main {

	public static void main(String[] args) throws Exception {

		double[][] trainData = new double[150][];
	
		trainData[0] = new double[] { 0.2231509789891368,0.9,0.7000000000000001,0.3666666666666667,0.6920000000000001,0.7000000000000001 };
		trainData[1] = new double[] { 0.43825538281402465,0.9,0.7000000000000001,0.3666666666666667,0.6920000000000001,0.7000000000000001 };
		trainData[2] = new double[] { 0.11027775970857998,0.9,0.7000000000000001,0.3666666666666667,0.276,0.9 };
		trainData[3] = new double[] { 0.32743771547518374,0.9,0.7000000000000001,0.3666666666666667,0.516,0.9 };
		trainData[4] = new double[] { 0.19908280751967736,0.9,0.7000000000000001,0.3666666666666667,0.4840000000000001,0.9 };
		trainData[5] = new double[] { 0.33191309438626165,0.1,0.5,0.1,0.676,0.9 };
		trainData[6] = new double[] { 0.15084238600143107,0.5,0.7000000000000001,0.1,0.8680000000000001,0.7000000000000001 };
		trainData[7] = new double[] { 0.12971443439797048,0.5,0.7000000000000001,0.1,0.8680000000000001,0.7000000000000001 };
		trainData[8] = new double[] { 0.1374162492681975,0.9,0.7000000000000001,0.6333333333333333,0.372,0.9 };
		trainData[9] = new double[] { 0.17644571651596955,0.7000000000000001,0.5,0.9000000000000001,0.7080000000000001,0.7000000000000001 };
		trainData[10] = new double[] { 0.12859558967020102,0.30000000000000004,0.30000000000000004,0.1,0.6920000000000001,0.1 };
		trainData[11] = new double[] { 0.22562284524816237,0.9,0.30000000000000004,0.3666666666666667,0.58,0.30000000000000004 };
		trainData[12] = new double[] { 0.14168347102062057,0.5,0.5,0.6333333333333333,0.1,0.7000000000000001 };
		trainData[13] = new double[] { 0.27063683080725953,0.9,0.7000000000000001,0.6333333333333333,0.388,0.7000000000000001 };
		trainData[14] = new double[] { 0.14636700709035322,0.7000000000000001,0.5,0.3666666666666667,0.30800000000000005,0.7000000000000001 };
		trainData[15] = new double[] { 0.13104143628439474,0.7000000000000001,0.5,0.1,0.4680000000000001,0.7000000000000001 };
		trainData[16] = new double[] { 0.1663500943212125,0.30000000000000004,0.5,0.3666666666666667,0.5,0.7000000000000001 };
		trainData[17] = new double[] { 0.12953229688414755,0.30000000000000004,0.5,0.6333333333333333,0.4840000000000001,0.5 };
		trainData[18] = new double[] { 0.18896116568008847,0.9,0.9,0.1,0.82,0.9 };
		trainData[19] = new double[] { 0.18131139009952515,0.7000000000000001,0.7000000000000001,0.6333333333333333,0.21200000000000002,0.5 };
		trainData[20] = new double[] { 0.1413191959929747,0.9,0.9,0.6333333333333333,0.74,0.7000000000000001 };
		trainData[21] = new double[] { 0.15961100630976388,0.7000000000000001,0.1,0.6333333333333333,0.532,0.7000000000000001 };
		trainData[22] = new double[] { 0.14168347102062057,0.30000000000000004,0.5,0.6333333333333333,0.5,0.7000000000000001 };
		trainData[23] = new double[] { 0.19549209653288233,0.5,0.7000000000000001,0.3666666666666667,0.42000000000000004,0.5 };
		trainData[24] = new double[] { 0.1947635464775906,0.7000000000000001,0.7000000000000001,0.3666666666666667,0.42000000000000004,0.7000000000000001 };
		trainData[25] = new double[] { 0.11907239966174463,0.5,0.1,0.3666666666666667,0.14800000000000002,0.7000000000000001 };
		trainData[26] = new double[] { 0.1293501593703246,0.5,0.30000000000000004,0.1,0.29200000000000004,0.5 };
		trainData[27] = new double[] { 0.12523905548689263,0.30000000000000004,0.1,0.3666666666666667,0.612,0.5 };
		trainData[28] = new double[] { 0.1099655239705978,0.7000000000000001,0.7000000000000001,0.6333333333333333,0.30800000000000005,0.7000000000000001 };
		trainData[29] = new double[] { 0.18222207766863982,0.7000000000000001,0.5,0.3666666666666667,0.612,0.5 };
		trainData[30] = new double[] { 0.11889026214792169,0.1,0.30000000000000004,0.3666666666666667,0.9,0.7000000000000001 };
		trainData[31] = new double[] { 0.11849996747544396,0.30000000000000004,0.30000000000000004,0.6333333333333333,0.4680000000000001,0.7000000000000001 };
		trainData[32] = new double[] { 0.9,0.7000000000000001,0.7000000000000001,0.3666666666666667,0.516,0.7000000000000001 };
		trainData[33] = new double[] { 0.1,0.30000000000000004,0.30000000000000004,0.6333333333333333,0.196,0.7000000000000001 };
		trainData[34] = new double[] { 0.13757236713718857,0.30000000000000004,0.1,0.6333333333333333,0.21200000000000002,0.7000000000000001 };
		trainData[35] = new double[] { 0.13494438300917194,0.30000000000000004,0.30000000000000004,0.6333333333333333,0.644,0.7000000000000001 };
		trainData[36] = new double[] { 0.17831913094386265,0.1,0.30000000000000004,0.6333333333333333,0.6920000000000001,0.30000000000000004 };
		trainData[37] = new double[] { 0.17699212905743836,0.7000000000000001,0.5,0.3666666666666667,0.7240000000000001,0.7000000000000001 };
		trainData[38] = new double[] { 0.19923892538866844,0.30000000000000004,0.1,0.9000000000000001,0.628,0.7000000000000001 };
		trainData[39] = new double[] { 0.25827749951213164,0.30000000000000004,0.7000000000000001,0.9000000000000001,0.404,0.5 };
		trainData[40] = new double[] { 0.12581148767319328,0.30000000000000004,0.30000000000000004,0.3666666666666667,0.32400000000000007,0.5 };
		trainData[41] = new double[] { 0.1827945098549405,0.7000000000000001,0.30000000000000004,0.9000000000000001,0.548,0.9 };
		trainData[42] = new double[] { 0.12188252130358421,0.7000000000000001,0.5,0.6333333333333333,0.4840000000000001,0.7000000000000001 };
		trainData[43] = new double[] { 0.34723866519222013,0.7000000000000001,0.5,0.3666666666666667,0.74,0.7000000000000001 };
		trainData[44] = new double[] { 0.13046900409809406,0.9,0.7000000000000001,0.3666666666666667,0.7080000000000001,0.9 };
		trainData[45] = new double[] { 0.23605672282573342,0.9,0.7000000000000001,0.3666666666666667,0.7080000000000001,0.9 };
		trainData[46] = new double[] { 0.15495348988486307,0.7000000000000001,0.7000000000000001,0.3666666666666667,0.8680000000000001,0.9 };
		trainData[47] = new double[] { 0.24053210173681128,0.7000000000000001,0.7000000000000001,0.3666666666666667,0.852,0.9 };
		trainData[48] = new double[] { 0.13981005659272752,0.5,0.5,0.1,0.548,0.7000000000000001 };
		trainData[49] = new double[] { 0.1252910947765563,0.9,0.9,0.3666666666666667,0.9,0.9 };
		trainData[50] = new double[] { 0.21680218565016587,0.9,0.9,0.3666666666666667,0.82,0.9 };
		trainData[51] = new double[] { 0.17925583815780916,0.7000000000000001,0.7000000000000001,0.9000000000000001,0.30800000000000005,0.7000000000000001 };
		trainData[52] = new double[] { 0.13814479932348925,0.7000000000000001,0.7000000000000001,0.3666666666666667,0.548,0.7000000000000001 };
		trainData[53] = new double[] { 0.3072464710856697,0.7000000000000001,0.7000000000000001,0.9000000000000001,0.33999999999999997,0.7000000000000001 };
		trainData[54] = new double[] { 0.329102972744422,0.7000000000000001,0.7000000000000001,0.9000000000000001,0.43600000000000005,0.7000000000000001 };
		trainData[55] = new double[] { 0.13288883106745594,0.1,0.5,0.6333333333333333,0.7879999999999999,0.7000000000000001 };
		trainData[56] = new double[] { 0.36821049892668967,0.9,0.9,0.6333333333333333,0.676,0.9 };
		trainData[57] = new double[] { 0.20670656345540883,0.9,0.7000000000000001,0.9000000000000001,0.644,0.9 };
		trainData[58] = new double[] { 0.28146100305730826,0.1,0.5,0.6333333333333333,0.132,0.1 };
		trainData[59] = new double[] { 0.19960320041631432,0.1,0.30000000000000004,0.3666666666666667,0.74,0.1 };
		trainData[60] = new double[] { 0.1426201782345671,0.1,0.30000000000000004,0.1,0.388,0.1 };
		trainData[61] = new double[] { 0.17358355558446628,0.30000000000000004,0.7000000000000001,0.1,0.372,0.1 };
		trainData[62] = new double[] { 0.17628959864697846,0.30000000000000004,0.30000000000000004,0.3666666666666667,0.32400000000000007,0.1 };
		trainData[63] = new double[] { 0.1558901970988096,0.1,0.30000000000000004,0.6333333333333333,0.1,0.1 };
		trainData[64] = new double[] { 0.12190854094841606,0.1,0.5,0.1,0.404,0.1 };
		trainData[65] = new double[] { 0.15602029532296885,0.7000000000000001,0.7000000000000001,0.1,0.21200000000000002,0.7000000000000001 };
		trainData[66] = new double[] { 0.17366161451896184,0.7000000000000001,0.30000000000000004,0.3666666666666667,0.132,0.7000000000000001 };
		trainData[67] = new double[] { 0.21266506212190203,0.1,0.5,0.3666666666666667,0.26,0.30000000000000004 };
		trainData[68] = new double[] { 0.10598451831132505,0.7000000000000001,0.7000000000000001,0.3666666666666667,0.404,0.7000000000000001 };
		trainData[69] = new double[] { 0.14785012684576856,0.5,0.5,0.3666666666666667,0.372,0.7000000000000001 };
		trainData[70] = new double[] { 0.19973329864047357,0.9,0.7000000000000001,0.6333333333333333,0.30800000000000005,0.7000000000000001 };
		trainData[71] = new double[] { 0.22588304169648085,0.9,0.1,0.3666666666666667,0.33999999999999997,0.7000000000000001 };
		trainData[72] = new double[] { 0.16473687634163794,0.1,0.30000000000000004,0.1,0.1,0.5 };
		trainData[73] = new double[] { 0.1054641254146881,0.1,0.1,0.3666666666666667,0.372,0.30000000000000004 };
		trainData[74] = new double[] { 0.20074806478891563,0.30000000000000004,0.30000000000000004,0.6333333333333333,0.356,0.30000000000000004 };
		trainData[75] = new double[] { 0.11584596370259546,0.1,0.30000000000000004,0.6333333333333333,0.5,0.30000000000000004 };
		trainData[76] = new double[] { 0.30841735510310286,0.9,0.7000000000000001,0.6333333333333333,0.58,0.1 };
		trainData[77] = new double[] { 0.21500683015676836,0.1,0.7000000000000001,0.1,0.404,0.1 };
		trainData[78] = new double[] { 0.1968451180641384,0.5,0.5,0.6333333333333333,0.24400000000000002,0.5 };
		trainData[79] = new double[] { 0.16582970142457557,0.1,0.30000000000000004,0.6333333333333333,0.18,0.1 };
		trainData[80] = new double[] { 0.18635920119690366,0.7000000000000001,0.7000000000000001,0.3666666666666667,0.58,0.30000000000000004 };
		trainData[81] = new double[] { 0.195205880439732,0.9,0.9,0.6333333333333333,0.18,0.9 };
		trainData[82] = new double[] { 0.3095361998308723,0.9,0.7000000000000001,0.9000000000000001,0.4680000000000001,0.9 };
		trainData[83] = new double[] { 0.22132960385090744,0.9,0.7000000000000001,0.6333333333333333,0.7240000000000001,0.9 };
		trainData[84] = new double[] { 0.17930787744747284,0.7000000000000001,0.30000000000000004,0.3666666666666667,0.5640000000000001,0.7000000000000001 };
		trainData[85] = new double[] { 0.20821570285565605,0.1,0.1,0.6333333333333333,0.33999999999999997,0.1 };
		trainData[86] = new double[] { 0.13923762440642687,0.9,0.9,0.3666666666666667,0.4840000000000001,0.7000000000000001 };
		trainData[87] = new double[] { 0.15695700253691536,0.7000000000000001,0.1,0.9000000000000001,0.42000000000000004,0.7000000000000001 };
		trainData[88] = new double[] { 0.14428543550380538,0.30000000000000004,0.5,0.3666666666666667,0.74,0.7000000000000001 };
		trainData[89] = new double[] { 0.22177193781304885,0.5,0.7000000000000001,0.1,0.82,0.5 };
		trainData[90] = new double[] { 0.18877902816626552,0.7000000000000001,0.7000000000000001,0.6333333333333333,0.132,0.7000000000000001 };
		trainData[91] = new double[] { 0.14509204449359267,0.5,0.1,0.6333333333333333,0.14800000000000002,0.7000000000000001 };
		trainData[92] = new double[] { 0.14314057113120404,0.5,0.30000000000000004,0.3666666666666667,0.4680000000000001,0.5 };
		trainData[93] = new double[] { 0.20589995446562154,0.30000000000000004,0.1,0.1,0.74,0.5 };
		trainData[94] = new double[] { 0.13598516880244585,0.7000000000000001,0.7000000000000001,0.9000000000000001,0.164,0.7000000000000001 };
		trainData[95] = new double[] { 0.20824172250048786,0.7000000000000001,0.5,0.1,0.66,0.5 };
		trainData[96] = new double[] { 0.14490990697976974,0.1,0.30000000000000004,0.3666666666666667,0.9,0.7000000000000001 };
		trainData[97] = new double[] { 0.12630586092499838,0.30000000000000004,0.30000000000000004,0.6333333333333333,0.4680000000000001,0.7000000000000001 };
		trainData[98] = new double[] { 0.3535874585311911,0.7000000000000001,0.7000000000000001,0.3666666666666667,0.516,0.7000000000000001 };
		trainData[99] = new double[] { 0.1520392896636961,0.30000000000000004,0.30000000000000004,0.3666666666666667,0.196,0.7000000000000001 };
		trainData[100] = new double[] { 0.15838808300266702,0.30000000000000004,0.1,0.9000000000000001,0.21200000000000002,0.7000000000000001 };
		trainData[101] = new double[] { 0.1820399401548169,0.30000000000000004,0.30000000000000004,0.3666666666666667,0.644,0.7000000000000001 };
		trainData[102] = new double[] { 0.1426201782345671,0.1,0.30000000000000004,0.3666666666666667,0.388,0.1 };
		trainData[103] = new double[] { 0.17358355558446628,0.30000000000000004,0.7000000000000001,0.6333333333333333,0.372,0.1 };
		trainData[104] = new double[] { 0.1757692057503415,0.30000000000000004,0.30000000000000004,0.3666666666666667,0.32400000000000007,0.1 };
		trainData[105] = new double[] { 0.18190984193065765,0.1,0.30000000000000004,0.9000000000000001,0.132,0.1 };
		trainData[106] = new double[] { 0.1349183633643401,0.1,0.5,0.3666666666666667,0.404,0.1 };
		trainData[107] = new double[] { 0.21682820529499774,0.1,0.5,0.6333333333333333,0.21200000000000002,0.30000000000000004 };
		trainData[108] = new double[] { 0.1213361087621154,0.1,0.1,0.3666666666666667,0.372,0.30000000000000004 };
		trainData[109] = new double[] { 0.19814610030573082,0.30000000000000004,0.30000000000000004,0.9000000000000001,0.356,0.30000000000000004 };
		trainData[110] = new double[] { 0.1262538216353347,0.1,0.30000000000000004,0.1,0.58,0.30000000000000004 };
		trainData[111] = new double[] { 0.21209262993560138,0.9,0.7000000000000001,0.3666666666666667,0.4840000000000001,0.9 };
		trainData[112] = new double[] { 0.3030312886229103,0.1,0.5,0.1,0.676,0.9 };
		trainData[113] = new double[] { 0.13117153450855396,0.9,0.7000000000000001,0.6333333333333333,0.372,0.9 };
		trainData[114] = new double[] { 0.15841410264749886,0.30000000000000004,0.5,0.6333333333333333,0.4840000000000001,0.5 };
		trainData[115] = new double[] { 0.2019709880960125,0.9,0.9,0.1,0.82,0.9 };
		trainData[116] = new double[] { 0.2021271059650036,0.7000000000000001,0.7000000000000001,0.6333333333333333,0.21200000000000002,0.5 };
		trainData[117] = new double[] { 0.16473687634163794,0.9,0.9,0.6333333333333333,0.58,0.7000000000000001 };
		trainData[118] = new double[] { 0.1882326156247967,0.7000000000000001,0.1,0.6333333333333333,0.372,0.7000000000000001 };
		trainData[119] = new double[] { 0.18190984193065765,0.1,0.30000000000000004,0.6333333333333333,0.1,0.1 };
		trainData[120] = new double[] { 0.1479281857802641,0.1,0.5,0.9000000000000001,0.404,0.1 };
		trainData[121] = new double[] { 0.2089702725557796,0.1,0.30000000000000004,0.9000000000000001,0.1,0.5 };
		trainData[122] = new double[] { 0.12211669810707085,0.1,0.1,0.6333333333333333,0.372,0.30000000000000004 };
		trainData[123] = new double[] { 0.20595199375528525,0.30000000000000004,0.30000000000000004,0.6333333333333333,0.356,0.30000000000000004 };
		trainData[124] = new double[] { 0.14186560853444352,0.1,0.30000000000000004,0.6333333333333333,0.5,0.30000000000000004 };
		trainData[125] = new double[] { 0.30893774799973983,0.9,0.7000000000000001,0.6333333333333333,0.58,0.1 };
		trainData[126] = new double[] { 0.19913484680934107,0.1,0.7000000000000001,0.3666666666666667,0.404,0.1 };
		trainData[127] = new double[] { 0.1851362778898068,0.5,0.5,0.6333333333333333,0.24400000000000002,0.5 };
		trainData[128] = new double[] { 0.15750341507838417,0.1,0.30000000000000004,0.6333333333333333,0.18,0.1 };
		trainData[129] = new double[] { 0.1605997528133741,0.7000000000000001,0.7000000000000001,0.1,0.58,0.30000000000000004 };
		trainData[130] = new double[] { 0.23371495479086712,0.1,0.1,0.6333333333333333,0.33999999999999997,0.1 };
		trainData[131] = new double[] { 0.14834450009757366,0.5,0.30000000000000004,0.6333333333333333,0.4680000000000001,0.5 };
		trainData[132] = new double[] { 0.2079815260521694,0.30000000000000004,0.1,0.1,0.74,0.5 };
		trainData[133] = new double[] { 0.15131073960840435,0.9,0.9,0.1,0.9,0.9 };
		trainData[134] = new double[] { 0.21420022116698106,0.9,0.9,0.1,0.82,0.9 };
		trainData[135] = new double[] { 0.17639367722630586,0.7000000000000001,0.7000000000000001,0.6333333333333333,0.30800000000000005,0.7000000000000001 };
		trainData[136] = new double[] { 0.15115462173941327,0.7000000000000001,0.7000000000000001,0.1,0.66,0.7000000000000001 };
		trainData[137] = new double[] { 0.30204254211930004,0.7000000000000001,0.7000000000000001,0.6333333333333333,0.32400000000000007,0.7000000000000001 };
		trainData[138] = new double[] { 0.1626553047550901,0.9,0.9,0.3666666666666667,0.356,0.7000000000000001 };
		trainData[139] = new double[] { 0.18818057633513302,0.7000000000000001,0.1,0.9000000000000001,0.388,0.7000000000000001 };
		trainData[140] = new double[] { 0.1598972224029142,0.30000000000000004,0.5,0.1,0.7240000000000001,0.7000000000000001 };
		trainData[141] = new double[] { 0.23738372471215768,0.5,0.7000000000000001,0.1,0.852,0.5 };
		trainData[142] = new double[] { 0.15500552917452676,0.7000000000000001,0.7000000000000001,0.6333333333333333,0.18,0.7000000000000001 };
		trainData[143] = new double[] { 0.3421908540948416,0.9,0.9,0.6333333333333333,0.676,0.9 };
		trainData[144] = new double[] { 0.20878813504195667,0.9,0.7000000000000001,0.6333333333333333,0.644,0.9 };
		trainData[145] = new double[] { 0.2702725557796136,0.1,0.5,0.9000000000000001,0.132,0.1 };
		trainData[146] = new double[] { 0.23087881350419567,0.1,0.5,0.9000000000000001,0.26,0.30000000000000004 };
		trainData[147] = new double[] { 0.30120991348468096,0.9,0.7000000000000001,0.9000000000000001,0.4680000000000001,0.9 };
		trainData[148] = new double[] { 0.17038313927014898,0.9,0.7000000000000001,0.6333333333333333,0.7240000000000001,0.9 };
		trainData[149] = new double[] { 0.1961165680088467,0.5,0.7000000000000001,0.1,0.82,0.5 };		
    	

		// neural network
	    int numInput = 5;
	    int numHidden = 7;
	    int numOutput = 1;
    
    	// genetic algorithm
	    int popSize = 20;
	    int maxGeneration = 900;
	    double exitError = 0.018;
	    double mutateRate = 0.10;
	    double mutateChange = 0.1;
	    double crossoverRate = 1.0;
	    double tau = 0.10;

	    MLP nn = new MLP(numInput, numHidden, numOutput);
	    
	    double[] bestWeights = nn.evolve(trainData, popSize, maxGeneration, exitError, mutateRate, mutateChange, crossoverRate, tau);
	    
	    
	    nn.setWeights(bestWeights);
	    
	    for(int i = 0; i < trainData.length; ++i){
	    	double[] in = Arrays.copyOfRange(trainData[i], 0, 5);
	    	double[] out = nn.computeOutputs(in);
	    	System.out.println("Esperado: "+trainData[i][5]+" Obtido: "+out[0]);
	    }
	}
}
